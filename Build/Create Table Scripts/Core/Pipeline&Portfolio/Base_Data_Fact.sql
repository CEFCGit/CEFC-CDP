CREATE TABLE [core].[Base_Data_Fact](
	[ID_Project] [nvarchar](100) NOT NULL,
	[ID_Loc_Project]  AS ([ID_Project]),
	[ID_Focus] [nvarchar](5) NULL,
	[ID_Priority] [nvarchar](3) NULL,
	[ID_Client_Sector] [nvarchar](50) NULL,
	[ID_Phase] [numeric](18, 0) NULL,
	[Amt_cBoardApproved] [numeric](15, 2) NULL,
	[Amt_cBoardApproved_Expiry] [nvarchar](60) NULL,
	[Amt_cBoardApprovedNotes] [nvarchar](900) NULL,
	[Amt_cCEFC] [numeric](15, 2) NULL,
	[Amt_cCEFC_Renewable] [numeric](15, 2) NULL,
	[Amt_cCEFCweighted] [numeric](15, 2) NULL,
	[Amt_cCGBR_5yr] [numeric](15, 10) NULL,
	[Amt_cCommitment] [numeric](15, 2) NULL,
	[Amt_cCommitment_Copy] [numeric](15, 2) NULL,
	[Amt_cConcessionality] [numeric](15, 2) NULL,
	[Amt_cEquity_Internal] [numeric](15, 2) NULL,
	[Amt_cEquity_Other] [numeric](15, 2) NULL,
	[Amt_cFunding_3rd_Party] [numeric](15, 2) NULL,
	[Amt_cFunding_Grant] [numeric](15, 2) NULL,
	[Amt_cFunding_Partner] [numeric](15, 2) NULL,
	[Amt_cProject] [numeric](15, 2) NULL,
	[Amt_cSubProjects_CEFC] [numeric](15, 2) NULL,
	[Amt_cSum_Funding_Other] [numeric](15, 2) NULL,
	[Amt_cTenor] [numeric](10, 2) NULL,
	[Amt_cYield] [numeric](15, 10) NULL,
	[c_Sum_Confirmed_Drawdowns] [numeric](17, 2) NULL,
	[c_Sum_Drawdowns] [numeric](15, 2) NULL,
	[calc_sort_due_month] [numeric](2, 0) NULL,
	[calc_sort_due_year] [numeric](2, 0) NULL,
	[calc_sort_end_month] [numeric](2, 0) NULL,
	[calc_sort_end_year] [numeric](2, 0) NULL,
	[calc_sort_start_month] [numeric](2, 0) NULL,
	[calc_sort_start_year] [numeric](2, 0) NULL,
	[cAssessment_Assumed_Project_Life] [numeric](20, 0) NULL,
	[cAssessment_Bond_Rate_Day_of_Commitment] [numeric](8, 6) NULL,
	[cAssessment_Consumption_Savings_GJ] [numeric](15, 2) NULL,
	[cAssessment_Consumption_Savings_GJ_Life] [numeric](15, 2) NULL,
	[cAssessment_Cost_of_Carbon] [numeric](12, 6) NULL,
	[cAssessment_count] [numeric](4, 0) NULL,
	[cAssessment_Credit_Risk] [numeric](4, 0) NULL,
	[cAssessment_NPV_CEFC_Cost] [numeric](15, 2) NULL,
	[cAssessment_NPV_Gov_Cost] [numeric](15, 2) NULL,
	[cAssessment_Savings_Annual_EnergyDollars] [numeric](12, 2) NULL,
	[cAssessment_Savings_Annual_GJ] [numeric](12, 6) NULL,
	[cAssessment_Savings_Annual_OperationDollars] [numeric](12, 2) NULL,
	[cAssessment_Savings_Annual_TCO2] [numeric](15, 2) NULL,
	[cAssessment_Savings_Annual_TCO2_Assumption] [numeric](12, 2) NULL,
	[cAssessment_Savings_Lifetime_EnergyDollars] [numeric](12, 2) NULL,
	[cAssessment_Savings_Lifetime_GJ] [numeric](12, 2) NULL,
	[cAssessment_Savings_Lifetime_OperationDollars] [numeric](12, 2) NULL,
	[cAssessment_Savings_TCO2_Life] [numeric](15, 2) NULL,
	[cAssessment_Savings_TCO2_toDate] [numeric](20, 0) NULL,
	[cCount_CMS_Docs_by_Project] [numeric](4, 0) NULL,
	[cCount_Obligations_by_ActiveUser] [numeric](4, 0) NULL,
	[cCount_Obligations_by_Project] [numeric](4, 0) NULL,
	[Ccount_SubProjects] [numeric](4, 0) NULL,
	[cCountOrganisations] [numeric](10, 0) NULL,
	[cIndustry_Capital_Sum] [numeric](8, 0) NULL,
	[CO2_dol_per_t] [numeric](15, 2) NULL,
	[CO2_te_savings] [numeric](10, 2) NULL,
	[countContracts] [numeric](4, 0) NULL,
	[countObligations] [numeric](4, 0) NULL,
	[countObligations_Due] [numeric](4, 0) NULL,
	[countObligations_Past_Due] [numeric](4, 0) NULL,
	[countObligationsNa] [numeric](4, 0) NULL,
	[countObligationsOpen] [numeric](4, 0) NULL,
	[countObligationsSatisfied] [numeric](4, 0) NULL,
	[countORG_Contacts] [numeric](3, 0) NULL,
	[countPhases] [numeric](3, 0) NULL,
	[countStrategicPartners] [numeric](2, 0) NULL,
	[cSubProjectcount] [numeric](4, 0) NULL,
	[cTechnologies_Sum] [numeric](10, 2) NULL,
	[cTechnology_C02_Sum] [numeric](3, 0) NULL,
	[cTechnology_Capital_Sum] [numeric](2, 0) NULL,
	[cTechnology_Renewable_Sum] [numeric](4, 2) NULL,
	[days_in_phase] [numeric](7, 0) NULL,
	[Days_Open] [numeric](7, 0) NULL,
	[Leverage_PrivateSector] [numeric](15, 9) NULL,
	[Leverage_Total] [numeric](10, 9) NULL,
	[Loss_Estimated_dollar] [numeric](15, 2) NULL,
	[Loss_Estimated_pct] [numeric](12, 8) NULL,
	[Loss_Given_Default_pct] [numeric](8, 4) NULL,
	[Nameplate_Generation_CapacityMW_Existing] [numeric](12, 6) NULL,
	[Nameplate_Generation_CapacityMW_New] [numeric](12, 6) NULL,
	[Referral_Project_Amt] [numeric](15, 2) NULL,
	[Secondary_Leverage_Amt] [numeric](15, 2) NULL,
	[sum_Amt_CEFC] [numeric](15, 2) NULL,
	[sum_Amt_CEFC_Renewable] [numeric](17, 2) NULL,
	[sum_Amt_CEFCConcessionality] [numeric](15, 2) NULL,
	[sum_Amt_CEFCweighted] [numeric](15, 2) NULL,
	[sum_Amt_Commitment] [numeric](17, 2) NULL,
	[sum_Amt_Project] [numeric](17, 2) NULL,
	[sum_by_account] [numeric](10, 0) NULL,
	[sum_by_due] [numeric](10, 0) NULL,
	[sum_by_end] [numeric](10, 0) NULL,
	[sum_by_start] [numeric](10, 0) NULL,
	[sum_by_status] [numeric](10, 0) NULL,
	[sum_Obligations_Due] [numeric](17, 2) NULL,
	[sum_Obligations_Past_Due] [numeric](17, 2) NULL,
	[sum_Obligations_Total] [numeric](17, 2) NULL,
	[sumCount] [numeric](8, 0) NULL,
	[sumCountProjects] [numeric](8, 0) NULL,
	[Dollar_over_time_CO2e_CEFC_Cost_Calc]  AS ([cAssessment_NPV_CEFC_Cost]/nullif([cAssessment_Savings_TCO2_Life],(0))),
	[Dollar_over_time_CO2e_Gov_Cost_calc]  AS ([cAssessment_NPV_Gov_Cost]/nullif([cAssessment_Savings_TCO2_Life],(0))),
	[CEFC_Capital_per_tCO2_Calc]  AS ([Amt_cCEFC]/nullif([cAssessment_Savings_TCO2_Life],(0))),
	[CEFC_Return_per_tCO2_Calc]  AS ([cAssessment_NPV_CEFC_Cost]/nullif([cAssessment_Savings_TCO2_Life],(0))),
	[Concessionality_Calc] [numeric](15, 2) NULL,
	[Concession_per_tCO2_Calc]  AS ([Concessionality_Calc]/nullif([cAssessment_Savings_TCO2_Life],(0))),
	[Concession_flag_Calc]  AS (case when [Concessionality_Calc]>(0) then 'Y' else 'N' end),
	[Total_Funds_Mobilised_Calc]  AS ((([Amt_cCEFC]+[Amt_cFunding_Partner])+[Amt_cEquity_Other])+[Amt_cFunding_Grant]),
	[Private_Sector_Leverage_Calc]  AS (([Amt_cEquity_Other]+[Amt_cFunding_Partner])/nullif([Amt_cCEFC],(0))),
	[Project_Capital_per_tCO2_Calc]  AS (((([Amt_cCEFC]+[Amt_cFunding_Partner])+[Amt_cEquity_Other])+[Amt_cFunding_Grant])/nullif([cAssessment_Savings_TCO2_Life],(0))),
	[Update_From_TS] [datetime] NOT NULL,
	[Update_to_TS] [datetime] NULL,
	[Updated_by] [nvarchar](20) NULL,
	[Update_Reason] [nvarchar](20) NULL,
 PRIMARY KEY ([ID_Project] ,[Update_From_TS])
 )

ALTER TABLE [core].[Base_Data_Fact] ADD  DEFAULT (NULL) FOR [Update_to_TS]
GO

ALTER TABLE [core].[Base_Data_Fact] ADD  DEFAULT ('SSIS ETL') FOR [Updated_by]
GO

ALTER TABLE [core].[Base_Data_Fact] ADD  DEFAULT ('Population process') FOR [Update_Reason]
GO

